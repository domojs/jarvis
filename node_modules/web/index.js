var debug=require('debug')('web');

debug=function(text)
{
    console.log(text)
};

exports.init=function(config, app)
{
	$.each(config, function(index, item){
		$.language($.extend(item, {
			process:function(cmd, context, callback, next)
			{
			    debug(cmd);
				var url=item.url || item.ajax.url;
				var isValid=true;
				url=url.replace(/\{([^}]+)\}/g, function(match, name){
				    if(typeof(cmd[name])=='undefined')
				        isValid=false;
					return cmd[name];
				});
				if(isValid==false)
				    return callback('hein ?');
				debug(url);
				$.ajax({url:url, success:function(){
					callback(null, 'requête envoyée');
				}, error:function(error){
					callback(error);
				}});
			}
		}));
	});
};



