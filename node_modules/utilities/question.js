$.language({
    "actions":{"which":["quel","quelle"], "is":["est-ce"]},
	"keywords":{"temperature":["temperature"], "time":["heure"], "rain":["va y avoir de la pluie", "qu'il va pleuvoir", "qu'il pleut"]},
	others:{"useless":["est-il", "fait-il", "fera-t-il"]},
	understand:function(cmd, context, next)
	{
		if(cmd.time && cmd.time.isValid())
			cmd.timeInfo=cmd.time;
			
		
		cmd.action=this.findInfo(this, 'actions', cmd.text);
        cmd.target=this.findInfo(this, 'keywords', cmd.text);
        cmd.other=this.findInfo(this, 'others', cmd.text);
		cmd.deferred=false;
		console.error(cmd);
        return cmd.target;
	},
	process:function(cmd, context, callback, next)
	{
        switch(cmd.target)
        {
            case 'time':
                callback(null, 'il est '+Date.create().format('{24hr}:{mm}'));
                break;
            case 'temperature':
            case 'rain':
                $.getJSON('http://localhost/api/weather/forecast/'+(cmd.time && cmd.time.isValid() ? cmd.time.daysFromNow()+1 : 0), function(forecast){
                    switch(cmd.target)
                    {
                        case 'temperature':
                            if(cmd.time && cmd.time.isFuture())
                            callback(null, 'il va faire entre '+forecast.low.celsius+'째 et '+forecast.high.celsius+'째');
                            else
                            callback(null, 'il fais entre '+forecast.low.celsius+'째 et '+forecast.high.celsius+'째');
                            break;
                        case 'rain':
                            if(cmd.action=='is')
                            {
                                
                            }
                            break;
                    }
                });
                break;
        }
	},
	
}); 